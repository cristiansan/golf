<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Golf App — Formulario, Links y QR</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="./vendor/qrcode.min.js?v=1"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/flowbite@2.3.0/dist/flowbite.min.js"></script>
    <script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <link rel="stylesheet" href="./styles.css?v=2" />
    <style>
      .nav-title { letter-spacing: 0.2px; }
      .tab-btn[aria-selected="true"] { outline: 1px solid var(--primary); box-shadow: 0 0 0 1px var(--primary) inset; }
      .thumb { aspect-ratio: 16 / 9; object-fit: cover; border-radius: 10px; border: 1px solid var(--border); background: #0b1220; }
      .drawer-surface { background: var(--card); border-left: 1px solid var(--border); transition: transform .3s ease-out; }
      .link-card { border: 1px solid var(--border); border-radius: 12px; padding: 12px; background: #0b1220; }
      .field { display: grid; gap: 6px; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
      .fade-in { animation: fadeIn 220ms ease-out both; }
      .btn { transition: transform .12s ease-out, opacity .12s ease-out; }
      .btn:active { transform: scale(0.98); }
    </style>
  </head>
  <body class="min-h-screen">
    <header class="sticky top-0 z-50 border-b" style="border-color: var(--border)">
      <div class="container flex items-center gap-3 py-1 relative">
        <h1 class="text-lg font-semibold nav-title">Golf App</h1>
        <button id="btn-drawer" class="absolute top-1 right-0 p-1 rounded-md border btn" style="border-color: var(--border);" aria-controls="app-drawer" aria-label="Abrir menú"><i data-lucide="menu"></i></button>
      </div>
    </header>

    <div id="app-drawer" data-drawer-placement="right" class="fixed top-0 right-0 z-40 h-screen w-64 translate-x-full transition-transform drawer-surface" tabindex="-1" aria-labelledby="app-drawer-label">
      <div class="relative min-h-screen pb-24 flex flex-col">
        <div class="px-4 py-1 border-b" style="border-color: var(--border)"></div>
        <nav class="p-2 space-y-1" style="margin-top: 25px;">
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="formulario">Formulario</button>
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="videos">Videos</button>
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="qr">QR</button>
          <div id="nav-admin-header" class="px-3 pt-3 text-xs muted" style="display:none;">Admin</div>
          <div id="nav-admin" class="space-y-1" style="display:none;">
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="links">Agregar Links</button>
          </div>
        </nav>
        <div class="absolute bottom-0 left-0 right-0 px-4 py-3 border-t" style="border-color: var(--border)">
          <div class="text-xs muted mb-2 text-center">Luciano Sancho Golf</div>
          <img id="drawer-logo" src="./logo.jpeg" alt="Logo" class="w-full block opacity-90" style="margin-bottom:0" onerror="this.style.display='none'; document.getElementById('logo-fallback')?.classList.remove('hidden');" />
          <div id="logo-fallback" class="hidden mt-2 flex items-center justify-center w-28 h-28 rounded-full border" style="border-color: var(--border); background:#000; color:#fff"><span class="text-xs">LS Golf</span></div>
          <div class="mt-2 text-center">
            <button id="btn-changelog" class="text-[11px] underline hover:no-underline muted">v0.5</button>
          </div>
        </div>
      </div>
    </div>

    <main class="container grid gap-6 py-4">
      <section id="sec-formulario" class="card-surface">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Formulario</h2>
        </div>
        <div class="flex gap-2 mb-3">
          <button class="tab-btn px-3 py-2 rounded-md border" style="border-color: var(--border)" data-tab="tab-personales" aria-selected="true">Datos Personales</button>
          <button class="tab-btn px-3 py-2 rounded-md border" style="border-color: var(--border)" data-tab="tab-medica">Info Médica</button>
          <button class="tab-btn px-3 py-2 rounded-md border" style="border-color: var(--border)" data-tab="tab-experiencia">Experiencia</button>
        </div>
        <form id="form-registro" class="grid gap-4">
          <div id="tab-personales" class="grid gap-3">
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field md:col-span-2">
                <input class="input-base" name="nombre" required placeholder="Nombre completo" />
              </label>
              <div class="grid grid-cols-2 gap-2">
                <label class="field">
                  <div class="grid grid-cols-[1fr_auto] items-center gap-2">
                    <input class="input-base" type="date" name="nacimiento" required aria-label="Fecha de Nacimiento" title="Fecha de Nacimiento" placeholder="Fecha nacimiento" />
                    <span class="text-xs muted leading-tight">Fecha Nacimiento</span>
                  </div>
                </label>
                <label class="field justify-self-end text-right">
                  <input class="input-base" id="edad" name="edad" placeholder="-" readonly maxlength="2" inputmode="numeric" style="width: 56px; text-align: right;" aria-label="Edad" title="Edad" />
                </label>
              </div>
            </div>
            <div class="grid gap-3">
              <label class="field">
                <input class="input-base" name="domicilio" placeholder="Direccion" />
              </label>
              <div class="grid grid-cols-2 gap-2">
                <label class="field">
                  <input class="input-base" name="ciudad" placeholder="Ciudad" />
                </label>
                <label class="field">
                  <input class="input-base" name="nacionalidad" placeholder="País" />
                </label>
              </div>
            </div>
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field">
                <input class="input-base" name="telefono" inputmode="tel" placeholder="Telefono" />
              </label>
              <label class="field">
                <input class="input-base" name="email" type="email" placeholder="Email" />
              </label>
              <label class="field">
                <input class="input-base" name="ocupacion" placeholder="Profesión / ocupación" />
              </label>
            </div>
          </div>
          <div id="tab-medica" class="hidden grid gap-3">
            <label class="field">
              <textarea class="textarea-base" name="alergias" rows="2" placeholder="Especificar alergias relevantes"></textarea>
            </label>
            <label class="field">
              <textarea class="textarea-base" name="lesiones" rows="2" placeholder="Lesiones o cirugías previas"></textarea>
            </label>
            <label class="field">
              <textarea class="textarea-base" name="condicion" rows="2" placeholder="Condición médica a tener en cuenta"></textarea>
            </label>
            <div class="grid md:grid-cols-3 gap-3 items-end">
              <label class="field">
                <select class="select-base" name="apto" aria-label="Apto médico" title="Apto médico">
                  <option value="" disabled selected>Apto Medico</option>
                  <option value="si">Si</option>
                  <option value="no">No</option>
                </select>
              </label>
              <label class="field">
                <div class="grid grid-cols-[1fr_auto] items-center gap-2">
                  <input class="input-base" type="date" name="apto_vto" aria-label="Vencimiento del apto" title="Vencimiento del apto" placeholder="Vencimiento apto medico" />
                  <span class="text-xs muted whitespace-nowrap">Fecha vencimiento</span>
                </div>
              </label>
              <div class="field">
                <div class="grid grid-cols-[auto,1fr] items-center gap-2">
                  <label for="apto_file" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Subir Apto Medico</label>
                  <span id="apto_file_name" class="text-xs muted truncate">Seleccionar Archivo</span>
                </div>
                <input id="apto_file" class="sr-only" type="file" name="apto_file" accept="image/*,.pdf" aria-label="Adjuntar apto" title="Adjuntar apto" />
              </div>
            </div>
          </div>
          <div id="tab-experiencia" class="hidden grid gap-3">
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field">
                <input class="input-base" type="number" name="anios" min="0" placeholder="Años practicando" />
              </label>
              <label class="field">
                <input class="input-base" type="number" name="handicap" step="0.1" placeholder="Hándicap actual" />
              </label>
              <label class="field">
                <select class="select-base" name="frecuencia" aria-label="Frecuencia semanal" title="Frecuencia semanal">
                  <option value="" disabled selected>Frecuencia semanal</option>
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4+</option>
                </select>
              </label>
            </div>
            <div class="grid md:grid-cols-2 gap-3">
              <label class="field">
                <input class="input-base" name="club" placeholder="Club o cancha" />
              </label>
              <label class="field">
                <select class="select-base" name="modalidad" aria-label="Modalidad preferida" title="Modalidad preferida">
                  <option value="" disabled selected>Modalidad preferida</option>
                  <option>Medal Play</option>
                  <option>Match Play</option>
                  <option>Otro</option>
                </select>
              </label>
            </div>
            <label id="modalidad-otro-row" class="field hidden">
              <input class="input-base" name="modalidad_otro" placeholder="Especificar modalidad" />
            </label>
            <label class="field">
              <select class="select-base" name="clases_previas" aria-label="Clases previas" title="Clases previas">
                <option value="" disabled selected>Clases Previas</option>
                <option>Sí</option>
                <option>No</option>
              </select>
            </label>
          </div>
          <div class="flex items-center justify-between pt-2 border-t" style="border-color: var(--border)">
            <button type="button" id="btn-prev" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Anterior</button>
            <div class="flex gap-2">
              <button type="button" id="btn-next" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Siguiente</button>
              <button type="submit" class="px-3 py-2 rounded-md btn-primary btn">Guardar</button>
            </div>
          </div>
        </form>
      </section>

      <section id="sec-links" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Agregar Links (YouTube)</h2>
        </div>
        <div class="grid gap-2 mb-3">
          <label class="field">Nombre
            <input id="yt-title" class="input-base" placeholder="Nombre del video" />
          </label>
          <label class="field">Link
            <input id="yt-url" class="input-base" placeholder="Pegar URL (https://...)" />
          </label>
          <div>
            <button id="btn-add-link" class="px-3 py-2 rounded-md btn-primary btn">Añadir</button>
          </div>
        </div>
        <div id="links-grid" class="grid-cards"></div>
      </section>

      <section id="sec-videos" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Videos</h2>
        </div>
        <div id="videos-grid" class="grid-cards"></div>
      </section>

      <section id="sec-qr" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Generador de QR</h2>
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="grid gap-3">
            <label class="field">URL destino
              <input id="qr-url" class="input-base" value="https://lucianosanchogolf.com.ar"/>
            </label>
            <div class="w-full grid place-items-center">
              <button id="btn-gen-qr" class="px-3 py-2 rounded-md btn-primary btn">Generar</button>
            </div>
          </div>
          <div class="grid place-items-center relative">
            <canvas id="qr-canvas" class="border rounded" style="border-color: var(--border); background:#0b1020; z-index:1"></canvas>
            <div id="qr-debug-overlay" class="absolute inset-0 pointer-events-none" style="border:1px dashed rgba(255,255,255,0.12);"></div>
            <div class="mt-3 w-full grid place-items-center">
              <button id="btn-share-qr" class="px-3 py-2 rounded-md btn-primary btn">Compartir</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Modal: Changelog -->
    <div id="modal-changelog" class="fixed inset-0 z-50 hidden">
      <div id="modal-changelog-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-lg mx-auto mt-24 bg-[#0f172a] border rounded-lg p-4" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold">Notas de versión</h3>
          <button id="btn-close-changelog" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        <div class="text-sm space-y-4" style="max-height: 60vh; overflow-y: auto; padding-right: 6px;">
          <div>
            <div class="font-medium mb-1">v0.6</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Link del QR actualizado.</li>
              <li>Admin: login tocando el logo con clave en Firebase; bloque “Admin” en el menú con “Agregar Links” y “Alumnos”.</li>
              <li>Alumnos: página con listado alfabético, al tocar un nombre completa el formulario.</li>
              <li>Videos: nueva sección pública en el menú; muestra los videos en modo solo lectura.</li>
              <li>Links: renombrado a “Agregar Links” y visible solo para admin.</li>
              <li>QR: botón “Compartir” debajo del QR; botones centrados.</li>
              <li>Estabilidad: auto long‑polling para Firestore y autenticación antes de leer config.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.4</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Integración con Firebase: Firestore para guardar formularios y Storage para subir apto (máx. 5 MB).</li>
              <li>Autenticación anónima requerida para guardar/subir.</li>
              <li>Mejoras de UI: placeholders en campos, etiquetas compactas y leyendas junto a fechas/archivos.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.3</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Formulario: edad auto al lado de la fecha de nacimiento.</li>
              <li>Edad compacta (máx. 2 dígitos) y alineada a la derecha.</li>
              <li>Campo “Ciudad” agregado debajo de “Domicilio”.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.2</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Links: formulario simplificado (Nombre, Link y botón Añadir).</li>
              <li>Listado en una sola columna; muestra título arriba de la miniatura (ya no editable).</li>
              <li>Seguridad: clave requerida para Añadir; propietario almacenado por hash.</li>
              <li>Borrado protegido: pide clave y valida contra propietario/administrador.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.1</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Estilos migrados a <code>styles.css</code> y corrección de rutas para GitHub Pages.</li>
              <li>Unificación del botón de menú con icono que alterna entre hamburguesa y X; posición a la derecha.</li>
              <li>Ajustes de espaciado del menú lateral y pie centrado.</li>
              <li>Separación del JS a <code>main.js</code>.</li>
              <li>Generador de QR simplificado (tamaño fijo) con fallback y librería local.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./main.js?v=5"></script>
  </body>
  </html>


