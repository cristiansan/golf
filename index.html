<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Golf App v1.4 — Formulario, Links y QR</title>
    
    <!-- Fuentes y estilos -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="./vendor/qrcode.min.js?v=1"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/flowbite@2.3.0/dist/flowbite.min.js"></script>
    <script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <link rel="stylesheet" href="./styles.css?v=2" />
    
    <!-- Estilos personalizados -->
    <style>
      .nav-title { letter-spacing: 0.2px; }
      .tab-btn[aria-selected="true"] { outline: 1px solid var(--primary); box-shadow: 0 0 0 1px var(--primary) inset; }
      .thumb { aspect-ratio: 16 / 9; object-fit: cover; border-radius: 10px; border: 1px solid var(--border); background: #0b1220; }
      .drawer-surface { background: var(--card); border-left: 1px solid var(--border); transition: transform .3s ease-out; }
      .link-card { border: 1px solid var(--border); border-radius: 12px; padding: 12px; background: #0b1220; }
      .field { display: grid; gap: 6px; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
      .fade-in { animation: fadeIn 220ms ease-out both; }
      .btn { transition: transform .12s ease-out, opacity .12s ease-out; }
      .btn:active { transform: scale(0.98); }
    </style>
  </head>
  <body class="min-h-screen">
    
    <!-- ===== OVERLAY DE LOGIN OBLIGATORIO ===== -->
    <!-- Se muestra cuando el usuario no está autenticado, bloqueando toda la app -->
    <div id="login-overlay" class="fixed inset-0 z-50 bg-black flex items-center justify-center">
      <div class="text-center">
        <div class="mb-6">
          <img src="./logo.jpeg" alt="Logo" class="mx-auto mb-4 rounded-lg opacity-90" />
        </div>
        <button id="btn-login-required" class="px-6 py-3 rounded-md btn-primary btn text-lg">
          Iniciar Sesión
        </button>
      </div>
    </div>

    <!-- ===== HEADER PRINCIPAL ===== -->
    <!-- Barra superior con título, info del usuario y botones de control -->
    <header class="sticky top-0 z-50 border-b" style="border-color: var(--border)">
      <div class="container flex items-center gap-3 py-1 relative">
        <h1 class="text-lg font-semibold nav-title">Golf App</h1>
        <div class="absolute top-1 right-0 flex items-center gap-2">
          <!-- Info del usuario logueado (oculto por defecto) -->
          <div id="user-info" class="hidden flex items-center gap-2">
            <span id="user-email" class="text-sm muted"></span>
            <button id="btn-logout" class="px-2 py-1 rounded-md border btn text-xs" style="border-color: var(--border);">Cerrar</button>
          </div>
          <!-- Botón de login (visible cuando no hay usuario) -->
          <button id="btn-login" class="px-3 py-1 rounded-md border btn text-sm" style="border-color: var(--border);">Iniciar Sesión</button>
          <!-- Botones de control -->
          <button id="btn-fullscreen" class="p-1 rounded-md border btn" style="border-color: var(--border);" aria-label="Pantalla completa" title="Pantalla completa"><i data-lucide="maximize-2"></i></button>
          <button id="btn-drawer" class="p-1 rounded-md border btn" style="border-color: var(--border);" aria-controls="app-drawer" aria-label="Abrir menú"><i data-lucide="menu"></i></button>
        </div>
      </div>
    </header>

    <!-- ===== DRAWER LATERAL (MENÚ) ===== -->
    <!-- Panel deslizable derecho con navegación y opciones -->
    <div id="app-drawer" data-drawer-placement="right" class="fixed top-0 right-0 z-40 h-screen w-64 translate-x-full transition-transform drawer-surface" tabindex="-1" aria-labelledby="app-drawer-label">
      <div class="relative min-h-screen pb-24 flex flex-col">
        <div class="px-4 py-1 border-b" style="border-color: var(--border)"></div>
        
        <!-- Navegación principal -->
        <nav class="p-2 space-y-1" style="margin-top: 25px;">
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="formulario">Formulario</button>
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="videos">Videos</button>
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="reserva">Reserva</button>
          <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="qr">QR</button>
          
          <!-- Sección de administrador (oculta por defecto) -->
          <div id="nav-admin-header" class="px-3 pt-3 text-xs muted" style="display:none;">Admin</div>
          <div id="nav-admin" class="space-y-1" style="display:none;">
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="links">Agregar Links</button>
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-black/20" data-section="reservas">Reservas</button>
          </div>
        </nav>
        
        <!-- Pie del drawer con logo y botones -->
        <div class="absolute bottom-0 left-0 right-0 px-4 py-3 border-t" style="border-color: var(--border)">
          <div class="text-xs muted mb-2 text-center">Luciano Sancho Golf</div>
          <img id="drawer-logo" src="./logo.jpeg" alt="Logo" class="w-3/4 mx-auto block opacity-90 rounded-full" style="margin-bottom:0" onerror="this.style.display='none'; document.getElementById('logo-fallback')?.classList.remove('hidden');" />
          <div id="logo-fallback" class="hidden mt-2 flex items-center justify-center w-28 h-28 rounded-full border" style="border-color: var(--border); background:#000; color:#fff"><span class="text-xs">LS Golf</span></div>
          <div class="mt-2 text-center">
            <button id="btn-fullscreen-drawer" class="w-full px-3 py-2 rounded-md border btn text-sm mb-2" style="border-color: var(--border);" aria-label="Pantalla completa" title="Pantalla completa">
              <i data-lucide="maximize-2" class="w-4 h-4 inline mr-2"></i><span>Pantalla Completa</span>
            </button>
            <button id="btn-changelog" class="text-[11px] underline hover:no-underline muted">v1.4</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== CONTENIDO PRINCIPAL ===== -->
    <main class="container grid gap-6 py-4">
      
      <!-- ===== SECCIÓN: FORMULARIO DE REGISTRO ===== -->
      <!-- Formulario principal con pestañas para datos personales, médicos y experiencia -->
      <section id="sec-formulario" class="card-surface">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Formulario</h2>
        </div>
        
        <!-- Pestañas del formulario -->
        <div class="grid grid-cols-2 gap-2 mb-3">
          <button class="tab-btn px-3 py-2 rounded-md border text-sm" style="border-color: var(--border)" data-tab="tab-personales" aria-selected="true">Datos Personales</button>
          <button class="tab-btn px-3 py-2 rounded-md border text-sm" style="border-color: var(--border)" data-tab="tab-medica">Info Médica</button>
          <button class="tab-btn px-3 py-2 rounded-md border text-sm" style="border-color: var(--border)" data-tab="tab-experiencia">Experiencia</button>
          <button id="tab-notas-btn" class="tab-btn px-3 py-2 rounded-md border text-sm hidden" style="border-color: var(--border)" data-tab="tab-notas">Notas</button>
        </div>
        
        <!-- Formulario principal -->
        <form id="form-registro" class="grid gap-4" novalidate>
          
          <!-- PESTAÑA 1: DATOS PERSONALES -->
          <div id="tab-personales" class="grid gap-3">
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field md:col-span-2">
                <input class="input-base" name="nombre" required placeholder="Nombre completo" />
              </label>
              <div class="grid grid-cols-2 gap-2">
                <label class="field">
                  <div class="grid grid-cols-[1fr_auto] items-center gap-2">
                    <input class="input-base" type="date" name="nacimiento" required aria-label="Fecha de Nacimiento" title="Fecha de Nacimiento" placeholder="Fecha nacimiento" />
                    <span class="text-xs muted leading-tight">Fecha Nacimiento</span>
                  </div>
                </label>
                <label class="field justify-self-end text-right">
                  <input class="input-base" id="edad" name="edad" placeholder="-" readonly maxlength="2" inputmode="numeric" style="width: 56px; text-align: right;" aria-label="Edad" title="Edad" />
                </label>
              </div>
            </div>
            <div class="grid gap-3">
              <label class="field">
                <input class="input-base" name="domicilio" placeholder="Direccion" />
              </label>
              <div class="grid grid-cols-2 gap-2">
                <label class="field">
                  <input class="input-base" name="ciudad" placeholder="Ciudad" />
                </label>
                <label class="field">
                  <input class="input-base" name="nacionalidad" placeholder="País" />
                </label>
              </div>
            </div>
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field">
                <input class="input-base" name="telefono" inputmode="tel" placeholder="Telefono" />
              </label>
              <label class="field">
                <input class="input-base" name="email" type="email" placeholder="Email" />
              </label>
              <label class="field">
                <input class="input-base" name="ocupacion" placeholder="Profesión / ocupación" />
              </label>
            </div>
          </div>
          
          <!-- PESTAÑA 2: INFORMACIÓN MÉDICA -->
          <div id="tab-medica" class="hidden grid gap-3">
            <label class="field">
              <textarea class="textarea-base" name="alergias" rows="2" placeholder="Especificar alergias relevantes"></textarea>
            </label>
            <label class="field">
              <textarea class="textarea-base" name="lesiones" rows="2" placeholder="Lesiones o cirugías previas"></textarea>
            </label>
            <label class="field">
              <textarea class="textarea-base" name="condicion" rows="2" placeholder="Condición médica a tener en cuenta"></textarea>
            </label>
            <div class="grid md:grid-cols-3 gap-3 items-end">
              <label class="field">
                <select class="select-base" name="apto" aria-label="Apto médico" title="Apto médico">
                  <option value="" disabled selected>Apto Medico</option>
                  <option value="si">Si</option>
                  <option value="no">No</option>
                </select>
              </label>
              <label class="field">
                <div class="grid grid-cols-[1fr_auto] items-center gap-2">
                  <input class="input-base" type="date" name="apto_vto" aria-label="Vencimiento del apto" title="Vencimiento del apto" placeholder="Vencimiento apto medico" />
                  <span class="text-xs muted whitespace-nowrap">Fecha vencimiento</span>
                </div>
              </label>
              <div class="field">
                <div class="grid grid-cols-[auto,1fr] items-center gap-2">
                  <label for="apto_file" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Subir Apto Medico</label>
                  <span id="apto_file_name" class="text-xs muted truncate">Seleccionar Archivo</span>
                </div>
                <input id="apto_file" class="sr-only" type="file" name="apto_file" accept="image/*,.pdf" aria-label="Adjuntar apto" title="Adjuntar apto" />
              </div>
            </div>
          </div>
          
          <!-- PESTAÑA 3: EXPERIENCIA EN GOLF -->
          <div id="tab-experiencia" class="hidden grid gap-3">
            <div class="grid md:grid-cols-3 gap-3">
              <label class="field">
                <input class="input-base" type="number" name="anios" min="0" placeholder="Años practicando" />
              </label>
              <label class="field">
                <input class="input-base" type="number" name="handicap" step="0.1" placeholder="Hándicap actual" />
              </label>
              <label class="field">
                <select class="select-base" name="frecuencia" aria-label="Frecuencia semanal" title="Frecuencia semanal">
                  <option value="" disabled selected>Frecuencia semanal</option>
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4+</option>
                </select>
              </label>
            </div>
            <div class="grid md:grid-cols-2 gap-3">
              <label class="field">
                <input class="input-base" name="club" placeholder="Club o cancha" />
              </label>
              <label class="field">
                <select class="select-base" name="modalidad" aria-label="Modalidad preferida" title="Modalidad preferida">
                  <option value="" disabled selected>Modalidad preferida</option>
                  <option>Medal Play</option>
                  <option>Match Play</option>
                  <option>Otro</option>
                </select>
              </label>
            </div>
            <label id="modalidad-otro-row" class="field hidden">
              <input class="input-base" name="modalidad_otro" placeholder="Especificar modalidad" />
            </label>
            <label class="field">
              <select class="select-base" name="clases_previas" aria-label="Clases previas" title="Clases previas">
                <option value="" disabled selected>Clases Previas</option>
                <option>Sí</option>
                <option>No</option>
              </select>
            </label>
          </div>
          
          <!-- PESTAÑA 4: NOTAS DEL ALUMNO (solo para administradores) -->
          <div id="tab-notas" class="hidden grid gap-3">
            <div class="grid gap-3">
              <label class="field">
                <span class="block text-sm font-medium mb-2">Notas del Alumno</span>
                <textarea id="notas-alumno" class="textarea-base" rows="6" placeholder="Escribe aquí las notas sobre el progreso, mejoras necesarias, observaciones del instructor, etc..."></textarea>
              </label>
              
              <div class="flex items-center justify-between">
                <span class="text-xs muted">Última actualización: <span id="notas-ultima-actualizacion">-</span></span>
                <button type="button" id="btn-guardar-notas" class="px-3 py-2 rounded-md btn-primary btn text-sm">Guardar Notas</button>
              </div>
            </div>
            
            <div class="border-t pt-3" style="border-color: var(--border)">
              <h4 class="text-sm font-medium mb-2">Historial de Notas</h4>
              <div id="historial-notas" class="space-y-2 max-h-40 overflow-y-auto">
                <!-- Las notas se cargarán dinámicamente aquí -->
              </div>
            </div>
          </div>
          
          <!-- Botones de navegación del formulario -->
          <div class="flex items-center justify-between pt-2 border-t" style="border-color: var(--border)">
            <button type="button" id="btn-prev" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Anterior</button>
            <div class="flex gap-2">
              <button type="button" id="btn-next" class="px-3 py-2 rounded-md border btn" style="border-color: var(--border)">Siguiente</button>
              <button type="submit" id="btn-guardar" class="px-3 py-2 rounded-md btn-primary btn hidden">Guardar</button>
            </div>
          </div>
        </form>
      </section>

      <!-- ===== SECCIÓN: AGREGAR LINKS (solo admin) ===== -->
      <!-- Panel para administradores agregar videos de YouTube -->
      <section id="sec-links" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Agregar Links (YouTube)</h2>
        </div>
        <div class="grid gap-2 mb-3">
          <label class="field">Nombre
            <input id="yt-title" class="input-base" placeholder="Nombre del video" />
          </label>
          <label class="field">Link
            <input id="yt-url" class="input-base" placeholder="Pegar URL (https://...)" />
          </label>
          <div>
            <button id="btn-add-link" class="px-3 py-2 rounded-md btn-primary btn">Añadir</button>
          </div>
        </div>
        <div id="links-grid" class="grid-cards"></div>
      </section>

      <!-- ===== SECCIÓN: VIDEOS ===== -->
      <!-- Biblioteca de videos para todos los usuarios (solo lectura) -->
      <section id="sec-videos" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Videos</h2>
        </div>
        <div id="videos-grid" class="grid-cards"></div>
      </section>

      <!-- ===== SECCIÓN: RESERVA ===== -->
      <!-- Sistema de reserva de clases con calendario y pago -->
      <section id="sec-reserva" class="card-surface hidden">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-base font-semibold">Reservar Clase</h2>
          <div class="text-sm muted">1 hora - $15.000</div>
        </div>
        
        <!-- Calendario responsive -->
        <div id="calendar-container" class="mb-4">
          <div id="calendar-header" class="flex items-center justify-between mb-4">
            <button id="prev-month" class="p-2 rounded-md border btn" style="border-color: var(--border)">
              <i data-lucide="chevron-left"></i>
            </button>
            <div id="current-month" class="font-medium"></div>
            <button id="next-month" class="p-2 rounded-md border btn" style="border-color: var(--border)">
              <i data-lucide="chevron-right"></i>
            </button>
          </div>
          
          <!-- Grid del calendario -->
          <div id="calendar-grid" class="grid grid-cols-7 gap-1 mb-4">
            <!-- Días de la semana -->
            <div class="text-center text-sm font-medium p-2 muted">Dom</div>
            <div class="text-center text-sm font-medium p-2 muted">Lun</div>
            <div class="text-center text-sm font-medium p-2 muted">Mar</div>
            <div class="text-center text-sm font-medium p-2 muted">Mié</div>
            <div class="text-center text-sm font-medium p-2 muted">Jue</div>
            <div class="text-center text-sm font-medium p-2 muted">Vie</div>
            <div class="text-center text-sm font-medium p-2 muted">Sáb</div>
          </div>
        </div>
        
        <!-- Horarios disponibles -->
        <div id="time-slots" class="hidden mb-4">
          <h3 class="font-medium mb-2">Horarios disponibles:</h3>
          <div id="time-grid" class="grid grid-cols-2 md:grid-cols-4 gap-2"></div>
        </div>
        
        <!-- Resumen de reserva -->
        <div id="booking-summary" class="hidden p-3 rounded-md border mb-4" style="border-color: var(--border); background: var(--card);">
          <div class="font-medium mb-2">Resumen de reserva:</div>
          <div id="booking-details" class="text-sm space-y-1 muted"></div>
          <div class="flex items-center justify-between pt-2 mt-2 border-t" style="border-color: var(--border);">
            <span class="font-medium">Total: $40.000</span>
            <span class="text-sm muted">Seña requerida: $20.000 (50%)</span>
          </div>
        </div>
        
        <!-- Botón de confirmar -->
        <button id="btn-confirm-booking" class="w-full px-4 py-3 rounded-md btn-primary font-medium hidden">
          Confirmar Reserva
        </button>
      </section>

      <!-- ===== SECCIÓN: GENERADOR DE QR ===== -->
      <!-- Herramienta para crear códigos QR personalizables -->
      <section id="sec-qr" class="card-surface hidden">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold">Generador de QR</h2>
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="grid gap-3">
            <label class="field">URL destino
              <input id="qr-url" class="input-base" value="https://lucianosanchogolf.com.ar"/>
            </label>
            <div class="w-full grid place-items-center">
              <button id="btn-gen-qr" class="px-3 py-2 rounded-md btn-primary btn">Generar</button>
            </div>
          </div>
          <div class="grid place-items-center relative">
            <canvas id="qr-canvas" class="border rounded" style="border-color: var(--border); background:#0b1020; z-index:1"></canvas>
            <div id="qr-debug-overlay" class="absolute inset-0 pointer-events-none" style="border:1px dashed rgba(255,255,255,0.12);"></div>
            <div class="mt-3 w-full grid place-items-center">
              <button id="btn-share-qr" class="px-3 py-2 rounded-md btn-primary btn">Compartir</button>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== SECCIÓN: GESTIÓN DE RESERVAS (solo admin) ===== -->
      <!-- Panel para administradores para ver y gestionar reservas -->
      <section id="sec-reservas" class="card-surface hidden">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-base font-semibold">Gestión de Reservas</h2>
          <button id="btn-refresh-reservas" class="px-3 py-2 rounded-md border btn text-sm" style="border-color: var(--border);">
            <i data-lucide="refresh-cw" class="w-4 h-4 inline mr-1"></i>Actualizar
          </button>
        </div>
        
        <!-- Lista de reservas -->
        <div id="reservas-list" class="space-y-3">
          <!-- Las reservas se cargarán dinámicamente aquí -->
        </div>
        
        <!-- Mensaje cuando no hay reservas -->
        <div id="no-reservas-message" class="text-center py-8 muted hidden">
          <i data-lucide="calendar-x" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
          <p>No hay reservas confirmadas</p>
        </div>
      </section>
    </main>

    <!-- ===== MODAL: LOGIN ===== -->
    <!-- Ventana de inicio de sesión con email/password y Google -->
    <div id="modal-login" class="fixed inset-0 z-50 hidden">
      <div id="modal-login-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-md mx-auto mt-24 bg-black border rounded-lg p-6" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-lg">Iniciar Sesión</h3>
          <button id="btn-close-login" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        
        <form id="login-form" class="space-y-4">
          <div class="field">
            <label class="block text-sm font-medium mb-2">Email</label>
            <input id="login-email" type="email" class="input-base w-full" placeholder="tu@email.com" required />
          </div>
          
          <div class="field">
            <label class="block text-sm font-medium mb-2">Contraseña</label>
            <input id="login-password" type="password" class="input-base w-full" placeholder="••••••••" required />
          </div>
          
          <div class="flex items-center justify-between">
            <label class="flex items-center">
              <input id="login-remember" type="checkbox" class="mr-2" />
              <span class="text-sm">Recordarme</span>
            </label>
            <button type="button" id="btn-forgot-password" class="text-sm text-blue-400 hover:text-blue-300">¿Olvidaste tu contraseña?</button>
          </div>
          
          <button type="submit" class="w-full px-4 py-2 rounded-md btn-primary btn">
            Iniciar Sesión
          </button>
        </form>
        
        <div class="mt-4 text-center">
          <span class="text-sm muted">¿No tienes cuenta?</span>
          <button id="btn-show-register" class="ml-2 text-sm text-blue-400 hover:text-blue-300">Registrarse</button>
        </div>
        
        <div class="mt-4 pt-4 border-t" style="border-color: var(--border)">
          <button id="btn-login-google" class="w-full px-4 py-2 rounded-md border btn flex items-center justify-center gap-2" style="border-color: var(--border)">
            <svg class="w-5 h-5" viewBox="0 0 24 24">
              <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
              <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
              <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
              <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            Continuar con Google
          </button>
        </div>
      </div>
    </div>

    <!-- ===== MODAL: CHANGELOG ===== -->
    <!-- Ventana con historial de cambios y versiones -->
    <div id="modal-changelog" class="fixed inset-0 z-50 hidden">
      <div id="modal-changelog-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-2xl mx-auto mt-24 bg-black border rounded-lg p-6" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-lg">Changelog - v1.4</h3>
          <button id="btn-close-changelog" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        
        <div class="space-y-4 max-h-96 overflow-y-auto">
          <div class="border-b pb-3" style="border-color: var(--border)">
            <div class="font-medium mb-1 text-purple-400">v1.4 🔧</div>
            <ul class="list-disc pl-5 space-y-1">
              <li><strong>GESTIÓN DE RESERVAS ADMIN:</strong> Nueva sección "Reservas" en menú administrativo para gestionar todas las reservas confirmadas.</li>
              <li><strong>PANEL ADMINISTRATIVO:</strong> Vista completa de reservas con información detallada del alumno (nombre, email, teléfono) y datos de la clase.</li>
              <li><strong>INFORMACIÓN DETALLADA:</strong> Muestra fecha, hora, instructor, estado de la reserva y metadatos (ID, fecha de creación, estado de pago).</li>
              <li><strong>ESTADO DE RESERVAS:</strong> Indicadores visuales que distinguen entre reservas activas y pasadas con colores distintivos.</li>
              <li><strong>CANCELACIÓN DE RESERVAS:</strong> Funcionalidad para eliminar reservas con diálogo de confirmación y actualización automática.</li>
              <li><strong>ACTUALIZACIÓN EN TIEMPO REAL:</strong> Botón de refresh manual y carga automática al acceder a la sección.</li>
              <li><strong>CORRECCIÓN QR PAGO:</strong> CVU corregido en QR de pago de placeholder genérico a datos bancarios reales (CVU: 0000003100041354955291).</li>
              <li>Interfaz consistente con el resto de la aplicación usando iconos Lucide y diseño responsive.</li>
            </ul>
          </div>
          <div class="border-b pb-3" style="border-color: var(--border)">
            <div class="font-medium mb-1 text-blue-400">v1.3 🚀</div>
            <ul class="list-disc pl-5 space-y-1">
              <li><strong>NUEVA FUNCIONALIDAD:</strong> Sistema de reservas completo con calendario interactivo responsive para móviles, tablets y desktop.</li>
              <li><strong>CALENDARIO INTELIGENTE:</strong> Selección de fechas con días pasados deshabilitados, horarios disponibles (09:00-18:00) y visualización de slots ocupados.</li>
              <li><strong>PROCESO DE PAGO:</strong> Modal de confirmación con QR para transferencia bancaria de seña (50% - $7.500) e instrucciones claras paso a paso.</li>
              <li><strong>SISTEMA PERSISTENTE:</strong> Reservas guardadas localmente con IDs únicos, limpieza automática de reservas expiradas y bloqueo de horarios ya reservados.</li>
              <li><strong>MOBILE-FIRST:</strong> Modal de pago optimizado para móviles con scroll, diseño responsive y QR ajustado para pantallas pequeñas.</li>
              <li>Navegación mejorada con nueva opción "Reserva" en el menú principal.</li>
            </ul>
          </div>
          <div class="border-b pb-3" style="border-color: var(--border)">
            <div class="font-medium mb-1 text-green-400">v1.2 🎉</div>
            <ul class="list-disc pl-5 space-y-1">
              <li><strong>CORRECCIÓN CRÍTICA:</strong> Solucionado problema de persistencia de videos para administradores. Videos ya no aparecen y desaparecen después de refrescar la página.</li>
              <li><strong>EXPORTACIÓN CSV:</strong> Agregado botón de descarga CSV en listado de alumnos con todos los campos del formulario (20 campos completos).</li>
              <li><strong>MEJOR UX:</strong> Removido modal molesto después de agregar videos. Flujo más limpio y directo.</li>
              <li>Eliminación mejorada de videos con sincronización forzada desde Firebase.</li>
              <li>Resueltas condiciones de carrera entre autenticación y carga de videos.</li>
              <li>Formato CSV compatible con Excel con codificación UTF-8.</li>
            </ul>
          </div>
          <div class="border-b pb-3" style="border-color: var(--border)">
            <div class="font-medium mb-1">v1.1</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Guardado del formulario en Firestore con creación/actualización, ownerUid y timestamps.</li>
              <li>Confirmación al guardar datos.</li>
              <li>Validación manual del formulario para evitar errores con campos requeridos en pestañas ocultas.</li>
              <li>Prellenado completo del formulario al seleccionar un alumno (incluye nacimiento, domicilio, ciudad, selects y textareas).</li>
              <li>Removido botón de "Cargar demo" y código asociado.</li>
            </ul>
          </div>
          <div class="border-b pb-3" style="border-color: var(--border)">
            <div class="font-medium mb-1">v1.0</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Sistema de videos para usuarios comunes.</li>
              <li>Los usuarios pueden ver videos agregados por administradores.</li>
              <li>Navegación mejorada con sección de videos.</li>
              <li>Sistema de notas por alumno para administradores.</li>
            </ul>
          </div>
        </div>
        
        <div class="mt-6 pt-4 border-t text-center" style="border-color: var(--border)">
          <p class="text-sm text-gray-400">Golf App v1.4 - Luciano Sancho Golf</p>
        </div>
      </div>
    </div>

    <!-- ===== MODAL: REGISTRO ===== -->
    <!-- Ventana para crear nueva cuenta -->
    <div id="modal-register" class="fixed inset-0 z-50 hidden">
      <div id="modal-register-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-md mx-auto mt-24 bg-[#0f172a] border rounded-lg p-6" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-lg">Crear Cuenta</h3>
          <button id="btn-close-register" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        
        <form id="register-form" class="space-y-4">
          <div class="field">
            <label class="block text-sm font-medium mb-2">Nombre completo</label>
            <input id="register-name" type="text" class="input-base w-full" placeholder="Tu nombre completo" required />
          </div>
          
          <div class="field">
            <label class="block text-sm font-medium mb-2">Email</label>
            <input id="register-email" type="email" class="input-base w-full" placeholder="tu@email.com" required />
          </div>
          
          <div class="field">
            <label class="block text-sm font-medium mb-2">Contraseña</label>
            <input id="register-password" type="password" class="input-base w-full" placeholder="••••••••" required minlength="6" />
          </div>
          
          <div class="field">
            <label class="block text-sm font-medium mb-2">Confirmar contraseña</label>
            <input id="register-confirm-password" type="password" class="input-base w-full" placeholder="••••••••" required minlength="6" />
          </div>
          
          <button type="submit" class="w-full px-4 py-2 rounded-md btn-primary btn">
            Crear Cuenta
          </button>
        </form>
        
        <div class="mt-4 text-center">
          <span class="text-sm muted">¿Ya tienes cuenta?</span>
          <button id="btn-show-login" class="ml-2 text-sm text-blue-400 hover:text-blue-300">Iniciar Sesión</button>
        </div>
      </div>
    </div>

    <!-- ===== MODAL: NOTAS DE VERSIÓN ===== -->
    <!-- Ventana con historial detallado de versiones -->
    <div id="modal-changelog" class="fixed inset-0 z-50 hidden">
      <div id="modal-changelog-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-lg mx-auto mt-24 bg-[#0f172a] border rounded-lg p-4" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold">Notas de versión</h3>
          <button id="btn-close-changelog" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        <div class="text-sm space-y-4" style="max-height: 60vh; overflow-y: auto; padding-right: 6px;">
          <div>
            <div class="font-medium mb-1">v0.9</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Edición de alumnos: al tocar un alumno se prellenan los datos en el formulario y se mantiene en la sección correspondiente.</li>
              <li>Guardado del formulario: ahora usa <code>serverTimestamp</code>, agrega <code>ownerUid</code> y distingue entre crear y actualizar.</li>
              <li>Compatibilidad Firestore: se excluyen archivos del guardado (apto médico) para evitar errores; manejo de permisos mejorado.</li>
              <li>Admin: al validar la clave se crea/actualiza el documento en <code>usuarios</code> con <code>role: 'admin'</code> para cumplir reglas.</li>
              <li>Reglas: ajustes para permitir edición por admin/propietario y campos nuevos (modalidad_otro, updatedAt, ownerUid).</li>
              <li>UI: overlay de login más limpio, se retiraron textos redundantes.</li>
              <li>Correcciones: errores de permisos, función no definida y estabilidad general.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.8</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Funcionalidad de pantalla completa implementada.</li>
              <li>Botón de pantalla completa en el header (icono compacto).</li>
              <li>Botón de pantalla completa en el drawer lateral (con texto descriptivo).</li>
              <li>Iconos dinámicos que cambian según el estado (maximizar/minimizar).</li>
              <li>Texto del botón del drawer se actualiza automáticamente.</li>
              <li>Salida de pantalla completa con tecla Escape.</li>
              <li>Compatibilidad multiplataforma (Chrome, Firefox, Safari, Edge).</li>
              <li>Detección automática de soporte del navegador.</li>
              <li>Integración perfecta con el sistema de autenticación existente.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.7</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Sistema de autenticación completo con Firebase Auth.</li>
              <li>Login obligatorio: la app no es accesible sin autenticación.</li>
              <li>Registro de usuarios con email/password y Google.</li>
              <li>Sistema de admin automático: usuarios con campo admin=true ven opciones especiales.</li>
              <li>Acceso a "Alumnos" y "Agregar Videos" solo para administradores.</li>
              <li>Persistencia de sesión y logout funcional.</li>
              <li>UI mejorada: overlay de login con logo y diseño minimalista.</li>
              <li>Recuperación de contraseña y validación de formularios.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.6</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Link del QR actualizado.</li>
              <li>Admin: login tocando el logo con clave en Firebase; bloque "Admin" en el menú con "Agregar Links" y "Alumnos".</li>
              <li>Alumnos: página con listado alfabético, al tocar un nombre completa el formulario.</li>
              <li>Videos: nueva sección pública en el menú; muestra los videos en modo solo lectura.</li>
              <li>Links: renombrado a "Agregar Links" y visible solo para admin.</li>
              <li>QR: botón "Compartir" debajo del QR; botones centrados.</li>
              <li>Estabilidad: auto long‑polling para Firestore y autenticación antes de leer config.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.4</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Integración con Firebase: Firestore para guardar formularios y Storage para subir apto (máx. 5 MB).</li>
              <li>Autenticación anónima requerida para guardar/subir.</li>
              <li>Mejoras de UI: placeholders en campos, etiquetas compactas y leyendas junto a fechas/archivos.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.3</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Formulario: edad auto al lado de la fecha de nacimiento.</li>
              <li>Edad compacta (máx. 2 dígitos) y alineada a la derecha.</li>
              <li>Campo "Ciudad" agregado debajo de "Domicilio".</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.2</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Links: formulario simplificado (Nombre, Link y botón Añadir).</li>
              <li>Listado en una sola columna; muestra título arriba de la miniatura (ya no editable).</li>
              <li>Seguridad: clave requerida para Añadir; propietario almacenado por hash.</li>
              <li>Borrado protegido: pide clave y valida contra propietario/administrador.</li>
            </ul>
          </div>
          <div>
            <div class="font-medium mb-1">v0.1</div>
            <ul class="list-disc pl-5 space-y-1">
              <li>Estilos migrados a <code>styles.css</code> y corrección de rutas para GitHub Pages.</li>
              <li>Unificación del botón de menú con icono que alterna entre hamburguesa y X; posición a la derecha.</li>
              <li>Ajustes de espaciado del menú lateral y pie centrado.</li>
              <li>Separación del JS a <code>main.js</code>.</li>
              <li>Generador de QR simplificado (tamaño fijo) con fallback y librería local.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== MODAL: LOGIN DE ADMINISTRADOR ===== -->
    <!-- Ventana para validar clave de administrador -->
    <div id="modal-admin-login" class="fixed inset-0 z-50 hidden">
      <div id="modal-admin-login-overlay" class="absolute inset-0 bg-black/60"></div>
      <div class="relative max-w-md mx-auto mt-24 bg-[#0f172a] border rounded-lg p-6" style="border-color: var(--border)">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-lg">Acceso Administrador</h3>
          <button id="btn-close-admin-login" class="p-2 rounded-md border btn" style="border-color: var(--border)"><i data-lucide="x"></i></button>
        </div>
        
        <div class="space-y-4">
          <div class="field">
            <label class="block text-sm font-medium mb-2">Clave de Administrador</label>
            <input id="admin-key-input" type="text" inputmode="numeric" pattern="[0-9]*" class="input-base w-full text-center text-lg tracking-widest" placeholder="••••••••" maxlength="8" required />
          </div>
          
          <button id="btn-validate-admin" class="w-full px-4 py-2 rounded-md btn-primary btn">
            Validar Clave
          </button>
        </div>
      </div>
    </div>

    <!-- ===== MODAL: PAGO DE RESERVA actualizado===== -->
    <!-- Modal para confirmar pago de seña con QR -->
    <div id="modal-payment" class="fixed inset-0 z-50 hidden overflow-y-auto">
      <div id="modal-payment-overlay" class="absolute inset-0 bg-black/70"></div>
      <div class="relative max-w-md mx-auto my-4 bg-black border rounded-lg p-6" style="border-color: var(--border); min-height: min-content;">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-lg">Confirmar Reserva</h3>
          <button id="btn-close-payment" class="p-2 rounded-md border btn" style="border-color: var(--border)">
            <i data-lucide="x"></i>
          </button>
        </div>
        
        <!-- Detalles de la reserva -->
        <div id="payment-booking-details" class="mb-4 p-3 rounded-md border" style="border-color: var(--border); background: var(--card);">
          <div class="font-medium mb-2">Detalles de la reserva:</div>
          <div id="payment-details" class="text-sm space-y-1 muted"></div>
          <div class="flex items-center justify-between pt-2 mt-2 border-t font-medium" style="border-color: var(--border);">
            <span>Seña requerida:</span>
            <span class="text-green-400">$20.000 (50%)</span>
          </div>
        </div>
        
        <!-- QR de pago -->
        <div class="text-left mb-4">
          <div class="mb-3">
            <div class="font-medium mb-1">Escanea el QR para pagar la seña:</div>
            <div class="text-sm muted"><b>CVU:</b> 0000003100041354955291</div>
            <div class="text-sm muted"><b>Alias:</b> lucianosancho22</div>
            <div class="text-sm muted"><b>Nombre:</b> Luciano Joaquin Sancho</div>

          </div>
          <canvas id="payment-qr" class="mx-auto border-2 rounded-lg" style="border-color: var(--border); background: white; width: 200px; height: 200px;"></canvas>
        </div>
        
        <!-- Instrucciones -->
        <div class="text-sm muted mb-4 p-3 rounded-md border" style="border-color: var(--border); background: #0b1220;">
          <div class="font-medium text-white mb-2">Instrucciones:</div>
          <ol class="list-decimal pl-4 space-y-1">
            <li>Escanea el código QR con tu app preferida</li>
            <li>Transfiere $20.000 (50% del total)</li>
            <li>Guarda el comprobante de pago</li>
            <li>Tu reserva quedará confirmada</li>
          </ol>
        </div>
        
        <!-- Botones -->
        <div class="grid grid-cols-2 gap-3">
          <button id="btn-cancel-payment" class="px-4 py-2 rounded-md border btn" style="border-color: var(--border)">
            Cancelar
          </button>
          <button id="btn-payment-done" class="px-4 py-2 rounded-md btn-primary font-medium">
            Ya Pagué
          </button>
        </div>
      </div>
    </div>

    <!-- Script principal de la aplicación -->
    <script type="module" src="./main.js?v=26"></script>
  </body>
</html>


